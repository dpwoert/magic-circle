{"version":3,"sources":["plugins/layers.js","plugins/seed.js","../node_modules/process/browser.js","../node_modules/is-electron/index.js","client.js","utils/slug.js","folder.js","layer.js","control.js","index.js"],"names":["LayersPlugin","client","layers","mapping","Map","addLayer","bind","addLayers","regenerate","addListener","evt","payload","setValue","path","value","console","log","forEach","l","layer","push","clear","data","map","toJSON","sendMessage","control","get","error","SeedPlugin","seed","generateSeed","getSeed","Math","random","process","module","exports","cachedSetTimeout","cachedClearTimeout","defaultSetTimout","Error","defaultClearTimeout","setTimeout","e","clearTimeout","runTimeout","fun","call","runClearTimeout","marker","queue","draining","currentQueue","queueIndex","cleanUpNextTick","length","concat","drainQueue","timeout","len","run","nextTick","args","Array","arguments","i","Item","array","prototype","apply","title","browser","env","argv","version","versions","noop","on","once","off","removeListener","removeAllListeners","emit","prependListener","prependOnceListener","listeners","name","binding","cwd","chdir","dir","umask","ipcRenderer","getNodeEnv","Client","channels","fn","setup","loop","plugins","P","nextFrame","play","window","__controls","__IPC","p","connect","document","nodeEnv","batch","channel","message","trigger","resetListeners","splice","indexOf","stop","send","to","startFrame","endFrame","frameRequest","requestAnimationFrame","cancelAnimationFrame","slug","str","replace","toLowerCase","Folder","parent","label","controls","GUI","addControls","c","addControl","folder","slugs","ensureUnique","newName","Layer","children","child","add","recursiveGenerate","basePath","f","set","key","Control","reference","type","options","initialValue","getValue","TextControl","SelectionControl","values","labels","IntControl","stepSize","FloatControl","range","start","end","size","ColorControl","alpha","BoolControl"],"mappings":"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","file":"index.map","sourceRoot":"../src","sourcesContent":["class LayersPlugin {\n\n  constructor(client){\n    this.client = client;\n    this.layers = [];\n    this.mapping = new Map();\n\n    // Setup client\n    this.client.addLayer = this.addLayer.bind(this);\n    this.client.addLayers = this.addLayers.bind(this);\n    this.client.regenerate = this.regenerate.bind(this);\n\n  }\n\n  connect(){\n    // Event listeners\n    this.client.addListener('control-set-value', (evt, payload) => {\n      this.setValue(payload.path, payload.value);\n    });\n\n    console.log('connect');\n    this.regenerate();\n  }\n\n  addLayers(...layers){\n    layers.forEach((l) => this.addLayer(l, false));\n    this.regenerate();\n  }\n\n  addLayer(layer, regenerate = true){\n    this.layers.push(layer);\n\n    // Regenerate tree if needed\n    if(regenerate){\n      this.regenerate();\n    }\n  }\n\n  regenerate(){\n    this.mapping.clear();\n    const data = this.layers.map(l => l.toJSON(this.mapping));\n\n    this.client.sendMessage('layers', data);\n  }\n\n  setValue(path, value){\n    const control = this.mapping.get(path);\n\n    if(control){\n      control.setValue(value);\n    } else {\n      console.error('could not update control', path, value);\n    }\n  }\n\n}\n\n export default LayersPlugin;\n","class SeedPlugin{\n\n  constructor(client){\n    this.client = client;\n    this.seed = 0;\n    this.generateSeed();\n\n    // Setup client\n    this.client.generateSeed = this.generateSeed.bind(this);\n    this.client.getSeed = this.getSeed.bind(this);\n  }\n\n  connect(){\n    this.client.sendMessage('seed', this.seed);\n\n    // Event listeners\n    this.client.addListener('generate-seed', () => {\n      this.generateSeed();\n    });\n  }\n\n  getSeed(){\n    return this.seed;\n  }\n\n  generateSeed(){\n    this.seed = Math.random();\n    this.client.sendMessage('seed', this.seed);\n  }\n\n}\n\nexport default SeedPlugin;\n","// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n","// https://github.com/electron/electron/issues/2288\nfunction isElectron() {\n    // Renderer process\n    if (typeof window !== 'undefined' && typeof window.process === 'object' && window.process.type === 'renderer') {\n        return true;\n    }\n\n    // Main process\n    if (typeof process !== 'undefined' && typeof process.versions === 'object' && !!process.versions.electron) {\n        return true;\n    }\n\n    // Detect the user agent when the `nodeIntegration` option is set to true\n    if (typeof navigator === 'object' && typeof navigator.userAgent === 'string' && navigator.userAgent.indexOf('Electron') >= 0) {\n        return true;\n    }\n\n    return false;\n}\n\nmodule.exports = isElectron;\n","import LayersPlugin from './plugins/layers';\nimport SeedPlugin from './plugins/seed';\n\nimport isElectron from 'is-electron';\n\n// load ipc renderer\nlet ipcRenderer = null;\n\nconst getNodeEnv = () => {\n  try {\n    return process.env.NODE_ENV;\n  } catch(e){\n    return 'development';\n  }\n}\n\nexport class Client {\n\n  constructor(...plugins){\n    this.listeners = [];\n    this.channels = [];\n    this.fn = {\n      setup: () => {},\n      loop: () => {},\n    };\n\n    //add plugins\n    plugins.push(LayersPlugin);\n    plugins.push(SeedPlugin);\n    this.plugins = plugins.map(P => new P(this));\n\n    //event binding\n    this.nextFrame = this.nextFrame.bind(this);\n\n    // Not electron so don't wait for connection to backend\n    if(!isElectron()){\n      this.fn.setup(this);\n      this.play();\n    } else {\n      // Add to window global to it can be reached by Electron\n      window.__controls = this;\n    }\n\n  }\n\n  connect(){\n    if(window.__IPC){\n      console.log('ðŸ”Œ Creative Controls loaded')\n      ipcRenderer = window.__IPC;\n      this.plugins.forEach(p => p.connect ? p.connect() : null);\n\n      // Send page information to front-end\n      this.sendMessage('page-information', {\n        title: document.title,\n        nodeEnv: getNodeEnv(),\n      });\n\n      // trigger setup hook\n      this.sendMessage('setup');\n      ipcRenderer.once('setup-response', (evt, payload) => {\n\n        //run setup script\n        if(this.fn.setup){\n          this.fn.setup(this);\n        }\n\n        // run actions after setup is done\n        this.batch(evt, payload);\n\n        //start rendering\n        this.play();\n      });\n    }\n  }\n\n  trigger(channel, evt, payload){\n    this.listeners.forEach(l => {\n      if(l.channel === channel){\n        l.fn(evt, payload);\n      }\n    })\n  }\n\n  batch(evt, payload){\n    payload.batch.forEach(message => {\n      this.trigger(message.channel, evt, message.payload);\n    })\n  }\n\n  addListener(channel, fn){\n    this.listeners.push({ channel, fn });\n    this.resetListeners();\n  }\n\n\n  removeListener(fn){\n    for( let i = this.listeners.length - 1 ; i >= 0 ; i++ ){\n      if(this.listeners[i].fn === fn){\n        this.listeners.splice(i, 1);\n      }\n    }\n\n    this.resetListeners();\n  }\n\n  resetListeners(){\n    if(ipcRenderer){\n\n      //delete all listeners\n      this.channels.forEach(channel => ipcRenderer.removeAllListeners(channel));\n      this.channels = [];\n\n      //get all channels\n      this.listeners.forEach(l => {\n        if(this.channels.indexOf(l.channel) === -1){\n          this.channels.push(l.channel);\n        }\n      });\n\n      //recreate listeners\n      this.channels.forEach(channel => {\n        ipcRenderer.on(channel, (evt, payload) => {\n          this.trigger(channel, evt, payload);\n        });\n      });\n\n      //play/stop messages\n      ipcRenderer.on('change-play-state', (evt, payload) => {\n        console.log('receive play state', payload)\n        if(payload === true){\n          this.play();\n        } else {\n          this.stop();\n        }\n      });\n\n      //batch messages\n      ipcRenderer.on('batch', (evt, payload) => {\n        this.batch(evt, payload);\n      });\n    }\n  }\n\n  sendMessage(channel, payload){\n    if(ipcRenderer){\n      ipcRenderer.send('intercom', { channel, payload, to: 'editor' });\n      console.log('send', channel, payload);\n    }\n  }\n\n  startFrame(){\n\n  }\n\n  endFrame(){\n\n  }\n\n  nextFrame(){\n\n    //measure FPS\n    this.startFrame();\n\n    //do user action\n    if(this.fn.loop){\n      this.fn.loop();\n    }\n\n    //end of FPS measurement\n    this.endFrame();\n\n    //Schedule next frame\n    this.frameRequest = requestAnimationFrame(this.nextFrame);\n\n  }\n\n  play(){\n    this.stop();\n    this.frameRequest = requestAnimationFrame(this.nextFrame);\n    this.sendMessage('play');\n  }\n\n  stop(){\n    if(this.frameRequest){\n      cancelAnimationFrame(this.frameRequest);\n    }\n    this.sendMessage('stop');\n  }\n\n  setup(fn){\n    this.fn.setup = fn;\n    return this;\n  }\n\n  loop(fn){\n    this.fn.loop = fn;\n    return this;\n  }\n\n}\n","const slug = str => str\n    .replace(/\\s/g, '-')\n    .replace(/[%()=:.,!#$@\"'/\\\\|?*+&]/g, '')\n    .replace(/^-+|-+$/g, '')\n    .replace(/-+/g, '-')\n    .toLowerCase();\n\nexport default slug;\n","import slug from './utils/slug';\n\nexport class Folder {\n\n  constructor(parent, label, ...controls){\n    this.controls = [];\n    this.slug = slug(label);\n    this.label = label;\n\n    //Add to parent\n    parent.GUI = parent.GUI || [];\n    parent.GUI.push(this);\n\n    if(controls.length > 0){\n      this.addControls(controls);\n    }\n  }\n\n  addControls(controls){\n    controls.forEach((c) => this.addControl(c));\n  }\n\n  addControl(control){\n    this.controls.push(control);\n  }\n\n  toJSON(){\n    return {\n      folder: true,\n      slug: this.slug,\n      label: this.label,\n      controls: this.controls.map(c => c.toJSON())\n    };\n  }\n\n}\n","import slug from './utils/slug';\n\nconst slugs = [];\n\nconst ensureUnique = slug => {\n  if(slugs.indexOf(slug) > -1){\n    let newName = slug;\n    let i = 1;\n    while(slugs.indexOf(newName) > -1){\n      newName = `${slug}-${i}`;\n      i = i+1;\n    }\n  } else {\n    return slug;\n  }\n}\n\nexport class Layer {\n\n  constructor(label){\n    this.label = label;\n    this.slug = ensureUnique(slug(label));\n    this.children = [];\n    this.GUI = [];\n  }\n\n  add(child){\n    this.children.push(child);\n    return this;\n  }\n\n  addTo(layer){\n    layer.add(this);\n    return this;\n  }\n\n  toJSON(mapping){\n    const recursiveGenerate = (layer, basePath) => {\n\n      const path = path ? `${basePath}.${layer.slug}` : layer.slug;\n      if(mapping){\n        layer.GUI.map(f =>\n          f.controls.map(c => mapping.set(`${path}.${f.slug}.${c.key}`, c))\n        );\n      }\n\n      return {\n        label: layer.label,\n        slug: layer.slug,\n        path: path,\n        children: layer.children.map(c => recursiveGenerate(c, path)),\n        controls: layer.GUI.map(f => f.toJSON())\n      };\n    }\n\n    // Get tree in json\n    return recursiveGenerate(this);\n  }\n\n}\n","export class Control {\n\n  constructor(reference, key){\n    this.type = 'text';\n    this.reference = reference;\n    this.key = key;\n    this.label = key;\n    this.options = {};\n    this.initialValue = this.reference[this.key];\n    return this;\n  }\n\n  /** Receive an updated value from the client */\n  setValue(value){\n    this.reference[this.key] = value;\n  }\n\n  /** returns current value of controls */\n  getValue(){\n    return this.reference[this.key];\n  }\n\n  /** Value has been updated outside of the controls */\n  update(){\n    // TODO read & send value\n  }\n\n  /** Reset to initial value */\n  reset(){\n    this.reference[this.key] = this.initialValue;\n  }\n\n  /** Sets the label for this control */\n  label(label){\n    this.label = label;\n    return this;\n  }\n\n  /** Add to folder */\n  addTo(parent){\n    parent.addControl(this);\n    return this;\n  }\n\n  toJSON(){\n    return {\n      type: this.type,\n      key: this.key,\n      label: this.label,\n      options: this.options,\n      value: this.getValue(),\n    };\n  }\n\n\n};\n\nexport class TextControl extends Control{}\n\nexport class SelectionControl extends Control{\n\n  constructor(reference, key){\n    super(reference, key);\n    this.type = 'selectionBox';\n  }\n\n  values(values){\n    this.options.values = values;\n    return this;\n  }\n\n  labels(){\n    this.options.labels = labels;\n    return this;\n  }\n\n}\n\nexport class IntControl extends Control{\n\n  constructor(reference, key){\n    super(reference, key);\n    this.type = 'int';\n  }\n\n  stepSize(stepSize){\n    this.options.stepSize = stepSize;\n    return this;\n  }\n\n}\n\nexport class FloatControl extends Control{\n\n  constructor(reference, key){\n    super(reference, key);\n    this.type = 'float';\n    this.options = {\n      range: [0, 100],\n      stepSize: 0,\n    }\n  }\n\n  range(start, end){\n    this.options.range = [start, end];\n    return this;\n  }\n\n  stepSize(size){\n    this.options.stepSize = size;\n    return this;\n  }\n\n}\n\nexport class ColorControl extends Control {\n\n  constructor(reference, key){\n    super(reference, key);\n    this.type = 'color';\n    this.options = {\n      alpha: false,\n    }\n  }\n\n  alpha(alpha){\n    this.options.alpha = !!alpha;\n    return this;\n  }\n\n}\n\nexport class BoolControl extends Control {\n\n  constructor(reference, key){\n    super(reference, key);\n    this.type = 'boolean';\n  }\n\n}\n","export { Client as Controls } from './client';\nexport { Folder } from './folder';\nexport { Layer } from './layer';\nexport {\n  Control,\n  TextControl,\n  SelectionControl,\n  IntControl,\n  FloatControl,\n  ColorControl,\n  BoolControl\n} from './control';\n"]}